<section id="report">

  <!-- HEADER -->
  <header class="report-header">
    <h2 class="report-title">Analyse: {{ report.project_name|e }}</h2>

    <div class="report-meta">
      <span class="badge">ğŸ“„ <strong>{{ report.valid_pages }}</strong> Seite(n)</span>

      <span class="badge">ğŸ§® Score:
        <strong>{{ report.total.score if report.total.score is not none else 'â€“' }}</strong>
        Â· Bewertung: {{ report.total.band|e }}
      </span>

      <span class="badge">ğŸŒ Hosting:
        <strong>{{ report.hosting_country|e }}</strong>
        ({{ report.hosting_org|e }})
      </span>
    </div>

    <div class="report-scorebar" style="--score: {{ report.total.score or 0 }}">
      <div class="score-line">
        <span>Gesamtscore</span>
        <span>{{ report.total.score if report.total.score is not none else 'nicht bewertbar' }}</span>
      </div>

      <div class="scorebar"></div>

      <!-- Hinweis -->
      <p class="score-note">
        Hinweis: Der Score basiert auf den gecrawlten Seiten und den dort gefundenen Evidenzen.
      </p>

      <!-- Nachhaltigkeits-EinschÃ¤tzung -->
      {% if report.total.score >= 75 %}
        <p class="score-note" style="margin-top: 0.6rem;">
          ğŸŒ¿ Der gecrawlte Ausschnitt zeigt deutliche Indizien einer nachhaltigen Editionspraxis.
        </p>
      {% elif report.total.score >= 50 %}
        <p class="score-note" style="margin-top: 0.6rem;">
          ğŸŒ± Der gecrawlte Ausschnitt weist mehrere Hinweise auf nachhaltige Editionsmerkmale auf.
        </p>
      {% elif report.total.score >= 25 %}
        <p class="score-note" style="margin-top: 0.6rem;">
          âš ï¸ Der gecrawlte Ausschnitt zeigt nur wenige Hinweise auf nachhaltige Editionsmerkmale.
        </p>
      {% else %}
        <p class="score-note" style="margin-top: 0.6rem;">
          â— Der gecrawlte Ausschnitt enthÃ¤lt kaum oder keine Hinweise auf nachhaltige Editionspraxis.
        </p>
      {% endif %}

    </div>
  </header>


  <!-- TABELLE -->
  <section class="report-table-section">
    <div class="table-wrap">
      <table class="report-table">
        <thead>
          <tr>
            <th>ğŸ” Was wurde geprÃ¼ft</th>
            <th>â­ Ergebnis</th>
            <th>ğŸ“ Hinweise & Evidenzen</th>
          </tr>
        </thead>

        <tbody>
          {% for cluster in report.rows %}
            <tr class="cluster-row">
              <td colspan="3">{{ cluster.section }}</td>
            </tr>

            {% for r in cluster["items"] %}
              <tr>
                <td class="label">{{ r.label|e }}</td>
                <td>{{ r.bewertung|e }}</td>
                <td>{{ r.hinweise | safe if r.hinweise else 'â€“' }}</td>
              </tr>
            {% endfor %}
          {% endfor %}
        </tbody>

      </table>
    </div>
  </section>


  <!-- STÃ„RKEN -->
  <section class="report-section">
    <h3 class="section-title">StÃ¤rken</h3>
    <ul class="section-list">
      {% for s in report.strengths %}
        <li>âœ… {{ s|e }}</li>
      {% else %}
        <li class="muted">â€“</li>
      {% endfor %}
    </ul>
  </section>

  <!-- SCHWÃ„CHEN -->
  <section class="report-section">
    <h3 class="section-title">SchwÃ¤chen</h3>
    <ul class="section-list">
      {% for w in report.weaknesses %}
        <li>âš ï¸ {{ w|e }}</li>
      {% else %}
        <li class="muted">â€“</li>
      {% endfor %}
    </ul>
  </section>

  <!-- FAZIT -->
  <section class="report-section">
    <h3 class="section-title">Zusammenfassung (KI-generiert)</h3>
    <p class="muted">{{ report.conclusion|e }}</p>
  </section>

</section>
